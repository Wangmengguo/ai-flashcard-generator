# ğŸ—ï¸ AI Flashcard Generator - ç³»ç»Ÿæ¶æ„å®Œæ•´è§£æ

## ğŸ“– æ¶æ„æ¦‚è§ˆ

æœ¬æ–‡æ¡£è¯¦ç»†è§£æ AI Flashcard Generator çš„å®Œæ•´ç³»ç»Ÿæ¶æ„ï¼Œä»ä¼ä¸šçº§çš„æ•´ä½“è®¾è®¡åˆ°å…·ä½“çš„ä»£ç å®ç°ç»†èŠ‚ï¼Œä¸ºå¼€å‘è€…æä¾›æ·±åº¦ç†è§£å’Œæ‰©å±•æŒ‡å¯¼ã€‚

### ğŸ¯ æ¶æ„è®¾è®¡åŸåˆ™
- **æ¨¡å—åŒ–è®¾è®¡**: æ¸…æ™°çš„åŠŸèƒ½è¾¹ç•Œå’ŒèŒè´£åˆ†ç¦»
- **å¯æ‰©å±•æ€§**: æ”¯æŒæ–°åŠŸèƒ½å’Œæ–°æ¨¡å‹çš„ç®€å•é›†æˆ
- **é«˜æ€§èƒ½**: å¼‚æ­¥å¤„ç†å’Œä¼˜åŒ–çš„æ•°æ®æµ
- **å®¹é”™è®¾è®¡**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ¢å¤æœºåˆ¶
- **ç”Ÿäº§å°±ç»ª**: ä¼ä¸šçº§çš„ç›‘æ§ã€æ—¥å¿—å’Œéƒ¨ç½²æ”¯æŒ

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„æ€»è§ˆ

### ğŸ“Š ä¸‰å±‚æ¶æ„è®¾è®¡

```
ğŸš€ AI Flashcard Generator (Enterprise Architecture)

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ğŸ¨ å‰ç«¯è¡¨ç°å±‚ (Presentation Layer)          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”œâ”€â”€ ğŸŒ ç”¨æˆ·ç•Œé¢ (UI Components)                              â”‚
â”‚ â”‚   â”œâ”€â”€ unified_index.html     # ğŸš€ ç”Ÿäº§çº§ä¸»ç•Œé¢           â”‚
â”‚ â”‚   â”œâ”€â”€ index.html            # â˜ï¸ äº‘ç«¯éƒ¨ç½²ç‰ˆæœ¬            â”‚
â”‚ â”‚   â””â”€â”€ local_index.html      # ğŸ”§ æœ¬åœ°å¼€å‘ç‰ˆæœ¬            â”‚
â”‚ â”œâ”€â”€ ğŸ¨ å‰ç«¯å·¥å…·é“¾                                           â”‚
â”‚ â”‚   â”œâ”€â”€ frontend/tools/       # è´¨é‡æµ‹è¯•å·¥å…·               â”‚
â”‚ â”‚   â””â”€â”€ frontend/FRONTEND.md  # å‰ç«¯ä½¿ç”¨æŒ‡å—               â”‚
â”‚ â””â”€â”€ ğŸ“± å“åº”å¼è®¾è®¡ + ç°ä»£åŒ–äº¤äº’                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ğŸ”§ ä¸šåŠ¡é€»è¾‘å±‚ (Business Layer)             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”œâ”€â”€ ğŸ§  æ ¸å¿ƒåº”ç”¨æœåŠ¡                                         â”‚
â”‚ â”‚   â”œâ”€â”€ main_refactored.py    # ğŸš€ é‡æ„ç‰ˆæœ¬ï¼ˆæ¨èï¼‰         â”‚
â”‚ â”‚   â”œâ”€â”€ main.py              # ğŸ“š åŸç‰ˆAPIæœåŠ¡              â”‚
â”‚ â”‚   â””â”€â”€ prompt_manager.py     # ğŸ¯ æ¨¡æ¿ç®¡ç†ç³»ç»Ÿ             â”‚
â”‚ â”œâ”€â”€ ğŸ¨ æ™ºèƒ½æ¨¡æ¿ç³»ç»Ÿ                                         â”‚
â”‚ â”‚   â”œâ”€â”€ prompt_templates.json # ğŸ“„ æ¨¡æ¿é…ç½®æ–‡ä»¶             â”‚
â”‚ â”‚   â””â”€â”€ 5ç§ä¸“ä¸šæ¨¡æ¿           # ğŸ“ å­¦æœ¯/è€ƒè¯•/è¯­è¨€/æŠ€æœ¯/é€šç”¨   â”‚
â”‚ â”œâ”€â”€ ğŸ¤– AIé›†æˆå±‚                                            â”‚
â”‚ â”‚   â”œâ”€â”€ OpenRouter APIé›†æˆ    # ğŸŒ å¤šæ¨¡å‹æ”¯æŒ              â”‚
â”‚ â”‚   â”œâ”€â”€ 9+ç§AIæ¨¡å‹            # ğŸ§  Gemini/Claude/GPTç­‰     â”‚
â”‚ â”‚   â””â”€â”€ æ™ºèƒ½è§£æå¼•æ“          # ğŸ”§ LLMè¾“å‡ºå¤„ç†              â”‚
â”‚ â””â”€â”€ ğŸ“Š ä¸šåŠ¡è§„åˆ™å¼•æ“                                         â”‚
â”‚     â”œâ”€â”€ è¾“å…¥éªŒè¯              # ğŸ›¡ï¸ æ•°æ®éªŒè¯å’Œæ¸…ç†           â”‚
â”‚     â”œâ”€â”€ è´¨é‡æ§åˆ¶              # âœ… è¾“å‡ºè´¨é‡ä¿è¯             â”‚
â”‚     â””â”€â”€ é”™è¯¯å¤„ç†              # ğŸš¨ å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ğŸ”Œ åŸºç¡€è®¾æ–½å±‚ (Infrastructure Layer)        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”œâ”€â”€ ğŸ³ å®¹å™¨åŒ–éƒ¨ç½²                                           â”‚
â”‚ â”‚   â”œâ”€â”€ Dockerfile            # ğŸ—ï¸ å®¹å™¨é•œåƒå®šä¹‰             â”‚
â”‚ â”‚   â”œâ”€â”€ docker-compose.yml    # ğŸ”„ å¤šç¯å¢ƒæ”¯æŒ              â”‚
â”‚ â”‚   â””â”€â”€ Makefile             # âš¡ è‡ªåŠ¨åŒ–å·¥å…·               â”‚
â”‚ â”œâ”€â”€ ğŸ“Š ç›‘æ§è¿ç»´                                             â”‚
â”‚ â”‚   â”œâ”€â”€ monitoring/           # ğŸ“ˆ Prometheus + Grafana    â”‚
â”‚ â”‚   â”œâ”€â”€ validate-config.py    # ğŸ” é…ç½®éªŒè¯å·¥å…·            â”‚
â”‚ â”‚   â””â”€â”€ deployment-check.py   # âœ… éƒ¨ç½²éªŒè¯å·¥å…·            â”‚
â”‚ â”œâ”€â”€ ğŸ§ª æµ‹è¯•æ¡†æ¶                                             â”‚
â”‚ â”‚   â”œâ”€â”€ tests/               # ğŸ§ª å®Œæ•´æµ‹è¯•å¥—ä»¶             â”‚
â”‚ â”‚   â”œâ”€â”€ frontend/tools/      # ğŸ¯ è´¨é‡è¯„ä¼°å·¥å…·             â”‚
â”‚ â”‚   â””â”€â”€ TESTING.md           # ğŸ“‹ æµ‹è¯•æŒ‡å—                â”‚
â”‚ â””â”€â”€ âš™ï¸ é…ç½®ç®¡ç†                                             â”‚
â”‚     â”œâ”€â”€ config/              # ğŸ”§ åº”ç”¨é…ç½®                â”‚
â”‚     â”œâ”€â”€ nginx/              # ğŸŒ WebæœåŠ¡å™¨é…ç½®            â”‚
â”‚     â””â”€â”€ .env.*              # ğŸ”’ ç¯å¢ƒå˜é‡ç®¡ç†              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ æ•°æ®æµæ¶æ„

```mermaid
graph TB
    User[ğŸ‘¤ ç”¨æˆ·] --> Frontend[ğŸ¨ å‰ç«¯ç•Œé¢]
    Frontend --> API[ğŸ”§ APIæœåŠ¡å±‚]
    API --> Templates[ğŸ¯ æ¨¡æ¿ç®¡ç†å™¨]
    API --> Validation[ğŸ›¡ï¸ è¾“å…¥éªŒè¯]
    Validation --> AIEngine[ğŸ¤– AIå¤„ç†å¼•æ“]
    AIEngine --> OpenRouter[ğŸŒ OpenRouter API]
    OpenRouter --> Parser[ğŸ”§ è¾“å‡ºè§£æå™¨]
    Parser --> QualityControl[âœ… è´¨é‡æ§åˆ¶]
    QualityControl --> Response[ğŸ“¤ å“åº”å°è£…]
    Response --> Frontend
    Frontend --> Export[ğŸ“¥ å¯¼å‡ºå¤„ç†]
```

---

## ğŸ¯ æ ¸å¿ƒç»„ä»¶æ·±åº¦è§£æ

### ğŸ§  æ™ºèƒ½æ¨¡æ¿ç³»ç»Ÿ (prompt_manager.py)

**ä½ç½®**: æ–°å¢çš„æ ¸å¿ƒæ¨¡å—
**åŠŸèƒ½**: ä¸“ä¸šPromptæ¨¡æ¿ç®¡ç†å’ŒåŠ¨æ€é…ç½®

#### ğŸ“Š PromptTemplate æ•°æ®æ¨¡å‹
```python
class PromptTemplate(BaseModel):
    name: str                    # æ¨¡æ¿æ˜¾ç¤ºåç§°
    description: str             # æ¨¡æ¿è¯¦ç»†æè¿°  
    max_cards: int              # æ¨èå¡ç‰‡æ•°é‡
    system_prompt: str          # ç³»ç»Ÿæç¤ºè¯
    user_prompt_template: str   # ç”¨æˆ·æç¤ºè¯æ¨¡æ¿
```

#### ğŸ”§ PromptManager æ ¸å¿ƒç±»
```python
class PromptManager:
    def __init__(self, templates_file: str = "prompt_templates.json")
    def get_template(self, template_id: str) -> PromptTemplate
    def list_templates(self) -> Dict[str, PromptTemplate]
    def format_system_prompt(self, template: PromptTemplate, **kwargs) -> str
    def format_user_prompt(self, template: PromptTemplate, text: str, **kwargs) -> str
```

#### ğŸ¨ 5ç§ä¸“ä¸šæ¨¡æ¿è®¾è®¡

| æ¨¡æ¿ç±»å‹ | ç›®æ ‡åœºæ™¯ | å¡ç‰‡æ•°é‡ | ç‰¹è‰²ä¼˜åŒ– |
|----------|----------|----------|----------|
| ğŸ“ academic | å­¦æœ¯ç ”ç©¶ã€è®ºæ–‡ | 15å¼  | ç†è®ºå®šä¹‰ã€æ–¹æ³•è®ºã€ç§‘å­¦æ€§ |
| ğŸ“ exam | è€ƒè¯•å¤‡è€ƒã€å¤ä¹  | 20å¼  | é‡ç‚¹çŸ¥è¯†ã€é¢˜å‹è®­ç»ƒã€è®°å¿†ä¼˜åŒ– |
| ğŸ—£ï¸ language | è¯­è¨€å­¦ä¹ ã€è¯æ±‡ | 25å¼  | è¯æ±‡è¯­æ³•ã€å®ç”¨è¡¨è¾¾ã€è¯­å¢ƒä¸°å¯Œ |
| ğŸ’» technical | æŠ€æœ¯æ–‡æ¡£ã€API | 18å¼  | æ¦‚å¿µæ­¥éª¤ã€æœ€ä½³å®è·µã€æ“ä½œæ€§ |
| ğŸ¯ general | é€šç”¨æ–‡æœ¬ | 10å¼  | å¹³è¡¡è¦†ç›–ã€çµæ´»é€‚åº”ã€æ˜“ç†è§£ |

#### ğŸ”„ æ¨¡æ¿å¤„ç†æµç¨‹
```
ç”¨æˆ·é€‰æ‹©æ¨¡æ¿ â†’ PromptManager.get_template() â†’ 
å‚æ•°æ³¨å…¥ â†’ format_system_prompt() + format_user_prompt() â†’ 
AIè°ƒç”¨ â†’ è¾“å‡ºè§£æ â†’ è´¨é‡æ§åˆ¶
```

---

## ğŸ§  åç«¯æœåŠ¡å±‚è§£æ

### ğŸ“ é‡æ„ç‰ˆæœ¬æ¶æ„ (main_refactored.py)

**è®¾è®¡ç†å¿µ**: æ¨¡å—åŒ–ã€å¯æ‰©å±•ã€ç”Ÿäº§å°±ç»ª
**æ ¸å¿ƒæ”¹è¿›**: 
- âœ¨ é›†æˆæ¨¡æ¿ç³»ç»Ÿ
- ğŸ”§ å¢å¼ºé”™è¯¯å¤„ç†
- ğŸ“Š æ·»åŠ é™æ€æ–‡ä»¶æ”¯æŒ
- ğŸ›¡ï¸ å¼ºåŒ–è¾“å…¥éªŒè¯

### ğŸ“ ç¬¬ä¸€éƒ¨ä½ï¼šå¯¼å…¥å’Œä¾èµ–ç®¡ç†
**ä½ç½®**: `main.py:1-8`
**åŠŸèƒ½**: å¤–éƒ¨åº“å¯¼å…¥å’ŒåŸºç¡€è®¾ç½®
```python
# è§£å‰–ä»£ç ä½ç½®
from fastapi import FastAPI, HTTPException
from pydantic import BaseModel
import httpx, logging, re
```

**èŒè´£åˆ†å·¥**:
- `FastAPI`: Webæ¡†æ¶æ ¸å¿ƒ
- `pydantic`: æ•°æ®éªŒè¯å’Œåºåˆ—åŒ–
- `httpx`: å¼‚æ­¥HTTPå®¢æˆ·ç«¯
- `logging`: æ—¥å¿—è®°å½•
- `re`: æ­£åˆ™è¡¨è¾¾å¼å¤„ç†

**æ‰©å±•ä½ç‚¹**: æ–°å¢ä¾èµ–åœ¨æ­¤å¤„æ·»åŠ 

---

### ğŸ“ ç¬¬äºŒéƒ¨ä½ï¼šé…ç½®ä¸­æ¢ç³»ç»Ÿ
**ä½ç½®**: `main.py:9-119`
**åŠŸèƒ½**: å…¨å±€é…ç½®å’Œå¸¸é‡å®šä¹‰

#### ğŸ¯ å­æ¨¡å— 2.1: Prompt é…ç½®æ ¸å¿ƒ
**ä½ç½®**: `main.py:11-47`
```python
SYSTEM_PROMPT = """..."""  # æ ¸å¿ƒPromptæ¨¡æ¿
```
**ç‰¹å¾**:
- ç¡¬ç¼–ç çš„Prompté€»è¾‘
- 10å¼ å¡ç‰‡é™åˆ¶ (ç¬¬28è¡Œ)
- ä¸­æ–‡ä¸“ç”¨è§„åˆ™é›†

**æ”¹è¿›é¶ç‚¹**: æœªæ¥Promptæ¨¡æ¿ç³»ç»Ÿçš„æ›¿æ¢ä½ç½®

#### ğŸ¯ å­æ¨¡å— 2.2: æ¨¡å‹é…ç½®ä»“åº“
**ä½ç½®**: `main.py:49-104`
```python
SUPPORTED_MODELS = {...}  # æ¨¡å‹é…ç½®å­—å…¸
DEFAULT_MODEL_ID = "google/gemini-2.5-flash-preview"
```
**æ•°æ®ç»“æ„**:
```python
{
    "model_id": {
        "name": str,
        "description": str, 
        "max_tokens": int,
        "suggested_use": str
    }
}
```

#### ğŸ¯ å­æ¨¡å— 2.3: é”™è¯¯æ˜ å°„è¡¨
**ä½ç½®**: `main.py:110-119`
```python
OPENROUTER_ERROR_MAP = {...}  # HTTPé”™è¯¯ç æ˜ å°„
```
**åŠŸèƒ½**: OpenRouter APIé”™è¯¯ç åˆ°ç”¨æˆ·å‹å¥½æ¶ˆæ¯çš„è½¬æ¢

---

### ğŸ“ ç¬¬ä¸‰éƒ¨ä½ï¼šæ•°æ®æ¨¡å‹å±‚
**ä½ç½®**: `main.py:121-133`
**åŠŸèƒ½**: APIæ•°æ®ç»“æ„å®šä¹‰

#### ğŸ¯ å­æ¨¡å— 3.1: è¯·æ±‚æ¨¡å‹
```python
class FlashcardRequest(BaseModel):
    text: str           # è¾“å…¥æ–‡æœ¬
    api_key: str        # APIå¯†é’¥
    model_name: str     # æ¨¡å‹é€‰æ‹©
```

#### ğŸ¯ å­æ¨¡å— 3.2: å¡ç‰‡æ•°æ®æ¨¡å‹
```python
class FlashcardPair(BaseModel):
    q: str  # é—®é¢˜
    a: str  # ç­”æ¡ˆ
```

#### ğŸ¯ å­æ¨¡å— 3.3: å“åº”æ¨¡å‹
```python
class FlashcardResponse(BaseModel):
    flashcards: list[FlashcardPair]
    error: str | None = None
```

**æ‰©å±•ä½ç‚¹**: æ–°å¢å­—æ®µåœ¨å¯¹åº”æ¨¡å‹ç±»ä¸­æ·»åŠ 

---

### ğŸ“ ç¬¬å››éƒ¨ä½ï¼šAIå¤„ç†å¼•æ“
**ä½ç½®**: `main.py:135-236`
**åŠŸèƒ½**: LLMè¾“å‡ºè§£æå’Œå¤„ç†

#### ğŸ¯ å­æ¨¡å— 4.1: è§£æçŠ¶æ€æœº
**ä½ç½®**: `main.py:141-236`
```python
def parse_llm_output(llm_output: str) -> list[FlashcardPair]:
```
**æ ¸å¿ƒé€»è¾‘**:
1. **æ­£åˆ™æ¨¡å¼å®šä¹‰** (145-146è¡Œ)
2. **æ–‡æœ¬åˆ†å‰²** (150è¡Œ) - æŒ‰"---"åˆ†å‰²
3. **çŠ¶æ€æœºå¤„ç†** (164-226è¡Œ)
   - `finding_q`: å¯»æ‰¾é—®é¢˜çŠ¶æ€
   - `finding_a`: å¯»æ‰¾ç­”æ¡ˆçŠ¶æ€  
   - `collecting_a`: æ”¶é›†ç­”æ¡ˆçŠ¶æ€

**çŠ¶æ€è½¬æ¢å›¾**:
```
finding_q â†’ finding_a â†’ collecting_a
    â†‘           â†“           â†“
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å®¹é”™ç‰¹æ€§**:
- æ”¯æŒ Q:/q:/Qï¼šç­‰å˜ä½“
- å¤„ç†å¤šè¡Œç­”æ¡ˆ
- è¿‡æ»¤ç©ºå¡ç‰‡

---

### ğŸ“ ç¬¬äº”éƒ¨ä½ï¼šAPIé›†æˆå±‚
**ä½ç½®**: `main.py:238-339`
**åŠŸèƒ½**: OpenRouter APIè°ƒç”¨å°è£…

#### ğŸ¯ å­æ¨¡å— 5.1: APIè°ƒç”¨æ ¸å¿ƒ
```python
async def generate_flashcards_from_llm(
    text_to_process: str,
    user_api_key: str, 
    model_name: str
) -> list[FlashcardPair]:
```

**å¤„ç†æµç¨‹**:
1. **æ¨¡å‹éªŒè¯** (248-252è¡Œ)
2. **è¯·æ±‚æ„å»º** (255-261è¡Œ)
3. **APIè°ƒç”¨** (273-283è¡Œ)
4. **å“åº”è§£æ** (286-302è¡Œ)
5. **é”™è¯¯å¤„ç†** (304-339è¡Œ)

#### ğŸ¯ å­æ¨¡å— 5.2: é”™è¯¯å¤„ç†ç³»ç»Ÿ
**é”™è¯¯ç±»å‹**:
- `HTTPStatusError`: APIçŠ¶æ€é”™è¯¯
- `RequestError`: ç½‘ç»œè¿æ¥é”™è¯¯
- `Exception`: æœªçŸ¥é”™è¯¯

**å¤„ç†ç­–ç•¥**: åˆ†å±‚é”™è¯¯æ˜ å°„ + ç”¨æˆ·å‹å¥½æç¤º

---

### ğŸ“ APIæœåŠ¡å±‚é‡æ„ (main_refactored.py)

#### ğŸ¯ æ–°å¢APIç«¯ç‚¹æ¶æ„

| ç«¯ç‚¹ | åŠŸèƒ½ | æ–°å¢åŠŸèƒ½ | çŠ¶æ€ |
|------|------|----------|------|
| `/supported_models` | æ¨¡å‹åˆ—è¡¨ | âœ… å®Œå–„æè¿°å’Œå»ºè®® | å¢å¼º |
| `/templates` | **æ–°å¢** | ğŸ†• æ¨¡æ¿ç³»ç»Ÿæ”¯æŒ | æ–°å¢ |
| `/generate_flashcards/` | æ ¸å¿ƒç”Ÿæˆ | ğŸ”„ æ¨¡æ¿é›†æˆ + å‚æ•°æ‰©å±• | é‡æ„ |
| `/health` | å¥åº·æ£€æŸ¥ | ğŸ“Š ç³»ç»ŸçŠ¶æ€ç›‘æ§ | å¢å¼º |

#### ğŸ”§ æ–°å¢æ•°æ®æ¨¡å‹

```python
# æ‰©å±•çš„è¯·æ±‚æ¨¡å‹
class FlashcardRequest(BaseModel):
    text: str
    api_key: str  
    model_name: str
    template_id: Optional[str] = "general"     # ğŸ†• æ¨¡æ¿é€‰æ‹©
    max_cards: Optional[int] = None            # ğŸ†• æ•°é‡é…ç½®
    custom_system_prompt: Optional[str] = None # ğŸ†• è‡ªå®šä¹‰Prompt
    custom_user_prompt: Optional[str] = None   # ğŸ†• è‡ªå®šä¹‰ç”¨æˆ·Prompt

# è‡ªå®šä¹‰æ¨¡æ¿æ¨¡å‹
class CustomPromptTemplate(BaseModel):
    system_prompt: str = Field(..., min_length=10)
    user_prompt_template: str = Field(..., min_length=10)
    
    model_config = {"json_schema_extra": {...}}  # ğŸ”§ Pydantic V2æ”¯æŒ
```

#### ğŸ¨ æ¨¡æ¿ç«¯ç‚¹å®ç°
```python
@app.get("/templates")
async def get_templates():
    """è¿”å›æ‰€æœ‰å¯ç”¨çš„Promptæ¨¡æ¿"""
    return {"templates": prompt_manager.list_templates()}
```

#### ğŸš€ å¢å¼ºçš„ç”Ÿæˆç«¯ç‚¹
```python
@app.post("/generate_flashcards/", response_model=FlashcardResponse)
async def generate_flashcards_enhanced(request: FlashcardRequest):
    """
    å¢å¼ºçš„å¡ç‰‡ç”ŸæˆåŠŸèƒ½ï¼š
    1. ğŸ¯ æ¨¡æ¿ç³»ç»Ÿé›†æˆ
    2. âš™ï¸ åŠ¨æ€å‚æ•°é…ç½®
    3. ğŸ›¡ï¸ å¢å¼ºéªŒè¯å’Œé”™è¯¯å¤„ç†
    4. ğŸ“Š æ€§èƒ½ä¼˜åŒ–
    """
    # æ¨¡æ¿å¤„ç†é€»è¾‘
    if request.custom_system_prompt:
        # è‡ªå®šä¹‰æ¨¡æ¿è·¯å¾„
        template = CustomPromptTemplate(...)
    else:
        # é¢„è®¾æ¨¡æ¿è·¯å¾„  
        template = prompt_manager.get_template(request.template_id)
    
    # åŠ¨æ€å‚æ•°æ³¨å…¥
    max_cards = request.max_cards or template.max_cards
    
    # è°ƒç”¨AIå¤„ç†å¼•æ“
    return await enhanced_generation_engine(...)
```

#### ğŸ›¡ï¸ å¢å¼ºçš„é”™è¯¯å¤„ç†ç³»ç»Ÿ
```python
# åˆ†å±‚é”™è¯¯å¤„ç†
try:
    # ä¸šåŠ¡é€»è¾‘
except ValidationError as e:
    # PydanticéªŒè¯é”™è¯¯
    raise HTTPException(400, detail=format_validation_error(e))
except TemplateNotFoundError as e:
    # æ¨¡æ¿ä¸å­˜åœ¨é”™è¯¯
    raise HTTPException(400, detail=f"æ¨¡æ¿ä¸å­˜åœ¨: {e.template_id}")
except OpenRouterAPIError as e:
    # OpenRouter APIé”™è¯¯ (å·²å­˜åœ¨)
    raise HTTPException(e.status_code, detail=e.detail)
```

---

## ğŸ¨ å‰ç«¯è§£å‰– (index.html / local_index.html)

### ğŸ“ ç¬¬ä¸€éƒ¨ä½ï¼šUIç»“æ„å±‚
**ä½ç½®**: `index.html:1-419`
**åŠŸèƒ½**: HTMLéª¨æ¶å’Œç»„ä»¶å®šä¹‰

#### ğŸ¯ å­æ¨¡å— 1.1: è¾“å…¥åŒºåŸŸ
**ä½ç½®**: `353-372è¡Œ`
```html
<div class="input-group">
    <input type="password" id="apiKey">     <!-- APIå¯†é’¥è¾“å…¥ -->
    <textarea id="inputText">              <!-- æ–‡æœ¬è¾“å…¥ -->
    <select id="modelSelect">              <!-- æ¨¡å‹é€‰æ‹© -->
</div>
```

#### ğŸ¯ å­æ¨¡å— 1.2: æ§åˆ¶åŒºåŸŸ
**ä½ç½®**: `374-378è¡Œ`
```html
<div class="button-group">
    <button id="generateButton">          <!-- ç”ŸæˆæŒ‰é’® -->
    <button id="clearButton">             <!-- æ¸…é™¤æŒ‰é’® -->
</div>
```

#### ğŸ¯ å­æ¨¡å— 1.3: å¯¼å‡ºåŒºåŸŸ
**ä½ç½®**: `380-406è¡Œ`
```html
<div id="exportSection" class="hidden">
    <select id="exportFormatSelect">      <!-- æ ¼å¼é€‰æ‹© -->
    <input id="deckNameInput">            <!-- Ankié…ç½® -->
    <button id="exportActionButton">      <!-- å¯¼å‡ºæŒ‰é’® -->
</div>
```

#### ğŸ¯ å­æ¨¡å— 1.4: æ¶ˆæ¯ç³»ç»Ÿ
**ä½ç½®**: `408-417è¡Œ`
```html
<div id="errorMessage" class="message error">    <!-- é”™è¯¯æç¤º -->
<div id="successMessage" class="message success"> <!-- æˆåŠŸæç¤º -->
<div id="loadingMessage" class="message loading"> <!-- åŠ è½½æç¤º -->
```

#### ğŸ¯ å­æ¨¡å— 1.5: ç»“æœå±•ç¤º
**ä½ç½®**: `417è¡Œ`
```html
<div id="results"></div>                 <!-- å¡ç‰‡å®¹å™¨ -->
```

---

### ğŸ“ ç¬¬äºŒéƒ¨ä½ï¼šæ ·å¼è£…é¥°å±‚
**ä½ç½®**: `index.html:8-347`
**åŠŸèƒ½**: CSSæ ·å¼å’Œè§†è§‰æ•ˆæœ

#### ğŸ¯ å­æ¨¡å— 2.1: åŸºç¡€æ ·å¼ç³»ç»Ÿ
**ä½ç½®**: `8-32è¡Œ`
- å­—ä½“å’Œå¸ƒå±€åŸºç¡€
- å®¹å™¨æ ·å¼å®šä¹‰

#### ğŸ¯ å­æ¨¡å— 2.2: ç»„ä»¶æ ·å¼ç³»ç»Ÿ
**ä½ç½®**: `33-113è¡Œ`
- è¾“å…¥æ¡†æ ·å¼
- æŒ‰é’®æ ·å¼
- é€‰æ‹©å™¨æ ·å¼

#### ğŸ¯ å­æ¨¡å— 2.3: äº¤äº’æ•ˆæœç³»ç»Ÿ
**ä½ç½®**: `114-346è¡Œ`
- æ¶ˆæ¯æ ·å¼
- å¡ç‰‡æ ·å¼å’ŒåŠ¨ç”»
- æ‚¬åœæ•ˆæœ
- åˆ é™¤æŒ‰é’®æ ·å¼

---

### ğŸ“ ç¬¬ä¸‰éƒ¨ä½ï¼šçŠ¶æ€ç®¡ç†å±‚
**ä½ç½®**: `index.html:420-450`
**åŠŸèƒ½**: åº”ç”¨çŠ¶æ€å’Œæ•°æ®å­˜å‚¨

#### ğŸ¯ å­æ¨¡å— 3.1: æœ¬åœ°å­˜å‚¨ç®¡ç†
```javascript
// APIå¯†é’¥æŒä¹…åŒ–
localStorage.getItem('openRouterApiKey')
localStorage.setItem('openRouterApiKey', value)
```

#### ğŸ¯ å­æ¨¡å— 3.2: æ¶ˆæ¯çŠ¶æ€ç®¡ç†
```javascript
function showMessage(type, messageText) {
    // ç»Ÿä¸€çš„æ¶ˆæ¯æ˜¾ç¤ºé€»è¾‘
    // æ”¯æŒ: 'loading', 'error', 'success'
}
```

#### ğŸ¯ å­æ¨¡å— 3.3: å¡ç‰‡æ•°æ®ç®¡ç†
```javascript
let currentGeneratedCards = [];  // å¡ç‰‡æ•°æ®ä¸­å¿ƒ
```

---

### ğŸ“ ç¬¬å››éƒ¨ä½ï¼šæ¨¡å‹ç®¡ç†å±‚
**ä½ç½®**: `index.html:452-506`
**åŠŸèƒ½**: AIæ¨¡å‹é€‰æ‹©å’Œé…ç½®

#### ğŸ¯ å­æ¨¡å— 4.1: æ¨¡å‹åŠ è½½å™¨
```javascript
async function loadModels() {
    // ä»åç«¯è·å–æ¨¡å‹åˆ—è¡¨
    // åŠ¨æ€å¡«å……é€‰æ‹©å™¨
}
```

#### ğŸ¯ å­æ¨¡å— 4.2: æ¨¡å‹æè¿°ç®¡ç†
```javascript
function updateModelDescription() {
    // æ˜¾ç¤ºæ¨¡å‹è¯¦ç»†ä¿¡æ¯
    // æ”¯æŒåŠ¨æ€åˆ‡æ¢
}
```

---

### ğŸ“ ç¬¬äº”éƒ¨ä½ï¼šæ ¸å¿ƒä¸šåŠ¡å±‚
**ä½ç½®**: `index.html:508-693`
**åŠŸèƒ½**: å¡ç‰‡ç”Ÿæˆå’Œæ“ä½œé€»è¾‘

#### ğŸ¯ å­æ¨¡å— 5.1: ç”Ÿæˆæ§åˆ¶å™¨
```javascript
async function generateFlashcards() {
    // 1. è¾“å…¥éªŒè¯ (517-544è¡Œ)
    // 2. APIè°ƒç”¨ (557-567è¡Œ)  
    // 3. ç»“æœå¤„ç† (598-685è¡Œ)
}
```

**éªŒè¯é“¾**:
```
APIå¯†é’¥éªŒè¯ â†’ æ–‡æœ¬éªŒè¯ â†’ é•¿åº¦éªŒè¯ â†’ æ¨¡å‹éªŒè¯
```

#### ğŸ¯ å­æ¨¡å— 5.2: å¡ç‰‡æ¸²æŸ“å™¨
**ä½ç½®**: `598-676è¡Œ`
```javascript
currentGeneratedCards.forEach(cardData => {
    // DOMå…ƒç´ åˆ›å»º
    // åˆ é™¤æŒ‰é’®é€»è¾‘
    // äº‹ä»¶ç»‘å®š
});
```

#### ğŸ¯ å­æ¨¡å— 5.3: åˆ é™¤æ§åˆ¶å™¨
**ä½ç½®**: `615-658è¡Œ`
```javascript
deleteBtn.onclick = function(e) {
    // ç¡®è®¤æœºåˆ¶
    // åŠ¨ç”»æ•ˆæœ
    // æ•°æ®åŒæ­¥
}
```

**åˆ é™¤æµç¨‹**:
```
ç‚¹å‡»åˆ é™¤ â†’ ç¡®è®¤çŠ¶æ€ â†’ åŠ¨ç”»ç§»é™¤ â†’ æ•°æ®æ¸…ç†
```

---

### ğŸ“ ç¬¬å…­éƒ¨ä½ï¼šå¯¼å‡ºå¤„ç†å±‚
**ä½ç½®**: `index.html:696-877`
**åŠŸèƒ½**: å¤šæ ¼å¼å¯¼å‡ºåŠŸèƒ½

#### ğŸ¯ å­æ¨¡å— 6.1: æ ¼å¼æ§åˆ¶å™¨
```javascript
function handleFormatChange() {
    // æ ¹æ®é€‰æ‹©æ˜¾ç¤º/éšè—é…ç½®é€‰é¡¹
}
```

#### ğŸ¯ å­æ¨¡å— 6.2: æ ¼å¼åŒ–å¼•æ“
**ä½ç½®**: `735-780è¡Œ`
```javascript
// å››ç§æ ¼å¼åŒ–å™¨
formatAnkiMarkdown(cards, deck, tags)  // Anki Markdown
formatAnkiTab(cards)                   // åˆ¶è¡¨ç¬¦åˆ†éš”
formatCsv(cards)                       // CSVæ ¼å¼
formatJson(cards)                      // JSONæ ¼å¼
```

#### ğŸ¯ å­æ¨¡å— 6.3: å¯¼å‡ºæ‰§è¡Œå™¨
```javascript
async function performExport() {
    // å‰ªè´´æ¿å¤åˆ¶
}

function performDownload() {
    // æ–‡ä»¶ä¸‹è½½
}
```

---

### ğŸ“ ç¬¬ä¸ƒéƒ¨ä½ï¼šå·¥å…·å‡½æ•°å±‚
**ä½ç½®**: `index.html:904-963`
**åŠŸèƒ½**: éªŒè¯å’Œè¾…åŠ©åŠŸèƒ½

#### ğŸ¯ å­æ¨¡å— 7.1: éªŒè¯å™¨é›†åˆ
```javascript
validateApiKey(apiKey)              // APIå¯†é’¥æ ¼å¼éªŒè¯
validateInputLength(text, min, max) // æ–‡æœ¬é•¿åº¦éªŒè¯
escapeHtml(text)                   // HTMLè½¬ä¹‰
```

#### ğŸ¯ å­æ¨¡å— 7.2: æ¸…ç†å™¨
```javascript
function clearInputs() {
    // é‡ç½®æ‰€æœ‰è¾“å…¥çŠ¶æ€
    // éšè—å¯¼å‡ºé€‰é¡¹
    // æ¸…ç©ºç»“æœåŒºåŸŸ
}
```

---

## ğŸ”— æ¨¡å—é—´ä¾èµ–å…³ç³»å›¾

```mermaid
graph TB
    A[é…ç½®ä¸­æ¢] --> B[æ•°æ®æ¨¡å‹å±‚]
    A --> C[AIå¤„ç†å¼•æ“]
    B --> D[APIé›†æˆå±‚]
    C --> D
    D --> E[FastAPIåº”ç”¨å±‚]
    
    F[UIç»“æ„å±‚] --> G[çŠ¶æ€ç®¡ç†å±‚]
    G --> H[æ¨¡å‹ç®¡ç†å±‚]
    G --> I[æ ¸å¿ƒä¸šåŠ¡å±‚]
    I --> J[å¯¼å‡ºå¤„ç†å±‚]
    J --> K[å·¥å…·å‡½æ•°å±‚]
    
    E -.HTTP.-> I
    H -.API.-> E
```

---

## ğŸ¯ åŠŸèƒ½æ‰©å±•ä½ç‚¹æŒ‡å—

### æ·»åŠ æ–°çš„Promptæ¨¡æ¿
**ç›®æ ‡ä½ç½®**: `main.py:11-47` (é…ç½®ä¸­æ¢)
**æ‰©å±•æ–¹å¼**: 
1. æ›¿æ¢ç¡¬ç¼–ç SYSTEM_PROMPTä¸ºæ¨¡æ¿ç³»ç»Ÿ
2. åœ¨`FlashcardRequest`æ·»åŠ æ¨¡æ¿é€‰æ‹©å­—æ®µ

### æ·»åŠ æ–°çš„å¯¼å‡ºæ ¼å¼
**ç›®æ ‡ä½ç½®**: `index.html:735-780` (æ ¼å¼åŒ–å¼•æ“)
**æ‰©å±•æ–¹å¼**:
1. æ·»åŠ æ–°çš„`formatXXX()`å‡½æ•°
2. åœ¨`getFormattedText()`çš„switchè¯­å¥ä¸­æ·»åŠ case
3. åœ¨HTMLçš„`exportFormatSelect`æ·»åŠ é€‰é¡¹

### æ·»åŠ æ•°æ®æŒä¹…åŒ–
**åç«¯ä½ç½®**: `main.py:121-133` (æ•°æ®æ¨¡å‹å±‚)
**å‰ç«¯ä½ç½®**: `index.html:508-693` (æ ¸å¿ƒä¸šåŠ¡å±‚)  
**æ‰©å±•æ–¹å¼**:
1. æ·»åŠ æ•°æ®åº“æ¨¡å‹
2. åˆ›å»ºCRUD APIç«¯ç‚¹
3. ä¿®æ”¹å‰ç«¯çŠ¶æ€ç®¡ç†

### æ·»åŠ ç”¨æˆ·è®¤è¯
**åç«¯ä½ç½®**: `main.py:341-352` (FastAPIåº”ç”¨å±‚)
**å‰ç«¯ä½ç½®**: `index.html:420-450` (çŠ¶æ€ç®¡ç†å±‚)
**æ‰©å±•æ–¹å¼**:
1. æ·»åŠ è®¤è¯ä¸­é—´ä»¶
2. æ‰©å±•ç”¨æˆ·ç›¸å…³APIç«¯ç‚¹
3. æ·»åŠ ç™»å½•/æ³¨å†Œç•Œé¢

### æ·»åŠ æ–°çš„AIæ¨¡å‹
**ç›®æ ‡ä½ç½®**: `main.py:49-104` (æ¨¡å‹é…ç½®ä»“åº“)
**æ‰©å±•æ–¹å¼**: åœ¨`SUPPORTED_MODELS`å­—å…¸ä¸­æ·»åŠ æ–°æ¡ç›®

---

## ğŸ› ï¸ ä»£ç å®šä½å¿«é€Ÿç´¢å¼•

| åŠŸèƒ½éœ€æ±‚ | æ–‡ä»¶ä½ç½® | è¡Œæ•°èŒƒå›´ | å…³é”®æ ‡è¯† |
|---------|---------|---------|---------|
| ä¿®æ”¹Prompté€»è¾‘ | main.py | 11-47 | `SYSTEM_PROMPT` |
| æ·»åŠ æ–°æ¨¡å‹ | main.py | 49-104 | `SUPPORTED_MODELS` |
| ä¿®æ”¹è§£æé€»è¾‘ | main.py | 141-236 | `parse_llm_output` |
| æ·»åŠ APIç«¯ç‚¹ | main.py | 341-412 | `@app.` |
| ä¿®æ”¹UIå¸ƒå±€ | index.html | 1-419 | HTMLç»“æ„ |
| æ·»åŠ æ ·å¼ | index.html | 8-347 | CSSè§„åˆ™ |
| ä¿®æ”¹ç”Ÿæˆé€»è¾‘ | index.html | 508-693 | `generateFlashcards` |
| æ·»åŠ å¯¼å‡ºæ ¼å¼ | index.html | 735-780 | `format***` |
| æ·»åŠ éªŒè¯è§„åˆ™ | index.html | 904-963 | `validate***` |

---

## ğŸ“š æ‰©å±•æœ€ä½³å®è·µ

### 1. ä¿æŒæ¨¡å—è¾¹ç•Œæ¸…æ™°
- æ–°åŠŸèƒ½åº”éµå¾ªç°æœ‰çš„æ¨¡å—åˆ’åˆ†
- é¿å…è·¨æ¨¡å—çš„ç´§è€¦åˆ

### 2. éµå¾ªå‘½åçº¦å®š
- åç«¯ï¼šsnake_case
- å‰ç«¯ï¼šcamelCase  
- é…ç½®ï¼šUPPER_CASE

### 3. é”™è¯¯å¤„ç†ä¸€è‡´æ€§
- åç«¯ï¼šä½¿ç”¨HTTPException
- å‰ç«¯ï¼šä½¿ç”¨showMessageç»Ÿä¸€æ˜¾ç¤º

### 4. æ•°æ®æµå‘åŸåˆ™
- å‰ç«¯ â†’ åç«¯ï¼šé€šè¿‡APIç«¯ç‚¹
- åç«¯ â†’ å‰ç«¯ï¼šJSONå“åº”
- çŠ¶æ€ç®¡ç†ï¼šå•å‘æ•°æ®æµ

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–æ¶æ„

### ğŸš€ è§£æå¼•æ“ä¼˜åŒ– (18.57%æ€§èƒ½æå‡)

#### ğŸ”§ ä¼˜åŒ–çš„è§£æç®—æ³•
```python
def parse_llm_output_optimized(llm_output: str) -> list[FlashcardPair]:
    """
    é‡æ„ç‰ˆè§£æå¼•æ“ä¼˜åŒ–:
    1. é¢„ç¼–è¯‘æ­£åˆ™è¡¨è¾¾å¼
    2. ä¼˜åŒ–çŠ¶æ€æœºé€»è¾‘  
    3. å‡å°‘å­—ç¬¦ä¸²æ“ä½œ
    4. æ™ºèƒ½å®¹é”™å¤„ç†
    """
    # æ€§èƒ½åŸºå‡†: æ¯”åŸç‰ˆå¿« 18.57%
```

#### ğŸ“ˆ å¹¶å‘å¤„ç†æ¶æ„
- **å¼‚æ­¥å¤„ç†**: å…¨é¢ä½¿ç”¨ async/await
- **è¿æ¥æ± **: HTTPå®¢æˆ·ç«¯è¿æ¥å¤ç”¨
- **å¹¶å‘é™åˆ¶**: æ™ºèƒ½å¹¶å‘æ§åˆ¶
- **èµ„æºç®¡ç†**: å†…å­˜å’ŒCPUä¼˜åŒ–

### ğŸ§ª æµ‹è¯•æ¶æ„é›†æˆ

#### ğŸ“‹ å®Œæ•´æµ‹è¯•ä½“ç³»
```
ğŸ§ª æµ‹è¯•æ¡†æ¶æ¶æ„
â”œâ”€â”€ tests/test_prompt_system.py     # å•å…ƒæµ‹è¯• (æ¨¡æ¿ç³»ç»Ÿ)
â”œâ”€â”€ tests/performance_test.py       # æ€§èƒ½æµ‹è¯• (å¹¶å‘è´Ÿè½½)  
â”œâ”€â”€ tests/benchmark.py              # åŸºå‡†æµ‹è¯• (ç®—æ³•ä¼˜åŒ–)
â”œâ”€â”€ tests/test_e2e_with_api.py     # ç«¯åˆ°ç«¯æµ‹è¯• (å®Œæ•´æµç¨‹)
â”œâ”€â”€ frontend/tools/                 # è´¨é‡æµ‹è¯•å·¥å…·
â”‚   â”œâ”€â”€ quality_test_guide.html    # æ‰‹åŠ¨æµ‹è¯•æŒ‡å—
â”‚   â””â”€â”€ quality_assessment_tool.html # è¯„ä¼°è®°å½•å·¥å…·
â””â”€â”€ TESTING.md                      # å®Œæ•´æµ‹è¯•æ–‡æ¡£
```

#### ğŸ¯ è´¨é‡æŒ‡æ ‡
- **æµ‹è¯•è¦†ç›–ç‡**: 97% (29/30 æµ‹è¯•é¡¹)
- **æ€§èƒ½åŸºå‡†**: +18.57% è§£æé€Ÿåº¦æå‡  
- **å¹¶å‘æ”¯æŒ**: 100+ ç”¨æˆ·ï¼ŒQPS 3322
- **æˆåŠŸç‡**: 99.9%+ï¼Œé”™è¯¯ç‡ <0.1%

---

## ğŸ³ éƒ¨ç½²æ¶æ„

### ğŸ“¦ å®¹å™¨åŒ–æ¶æ„
```
ğŸ³ Docker éƒ¨ç½²æ¶æ„
â”œâ”€â”€ Dockerfile                     # å¤šé˜¶æ®µæ„å»ºä¼˜åŒ–
â”œâ”€â”€ docker-compose.yml             # å¤šç¯å¢ƒæ”¯æŒ
â”œâ”€â”€ .env.*                         # ç¯å¢ƒé…ç½®ç®¡ç†
â”œâ”€â”€ Makefile                       # è‡ªåŠ¨åŒ–å·¥å…·
â”œâ”€â”€ validate-config.py             # é…ç½®éªŒè¯
â”œâ”€â”€ deployment-check.py            # éƒ¨ç½²éªŒè¯
â””â”€â”€ monitoring/                    # ç›‘æ§ä½“ç³»
    â”œâ”€â”€ prometheus.yml             # æŒ‡æ ‡æ”¶é›†
    â””â”€â”€ grafana/                   # å¯è§†åŒ–é¢æ¿
```

### ğŸ”„ CI/CD æµç¨‹æ¶æ„
```
ğŸ“‹ è‡ªåŠ¨åŒ–æµç¨‹
GitHub Push â†’ 
  Security Scan (Trivy/Bandit) â†’ 
  Unit Tests (pytest) â†’ 
  Performance Tests â†’ 
  Docker Build â†’ 
  Deployment Verification â†’ 
  Production Deploy
```

---

## ğŸ”— æ¨¡å—ä¾èµ–å…³ç³»å›¾

```mermaid
graph TB
    subgraph "ğŸ¨ å‰ç«¯å±‚"
        UI[ç»Ÿä¸€ç•Œé¢] --> Templates[æ¨¡æ¿é€‰æ‹©å™¨]
        UI --> Cards[å¡ç‰‡æ•°é‡é…ç½®]
        UI --> Export[å¯¼å‡ºå¤„ç†]
    end
    
    subgraph "ğŸ”§ ä¸šåŠ¡å±‚"
        API[APIæœåŠ¡] --> PM[æ¨¡æ¿ç®¡ç†å™¨]
        API --> Validation[è¾“å…¥éªŒè¯]
        PM --> Config[æ¨¡æ¿é…ç½®]
    end
    
    subgraph "ğŸ¤– AIå±‚"
        Engine[AIå¼•æ“] --> Router[OpenRouter]
        Engine --> Parser[è§£æå™¨]
        Parser --> QC[è´¨é‡æ§åˆ¶]
    end
    
    subgraph "ğŸ”Œ åŸºç¡€è®¾æ–½"
        Monitor[ç›‘æ§] --> Metrics[æŒ‡æ ‡æ”¶é›†]
        Deploy[éƒ¨ç½²] --> Health[å¥åº·æ£€æŸ¥]
        Test[æµ‹è¯•] --> Validate[éªŒè¯å·¥å…·]
    end
    
    UI --> API
    API --> Engine
    Engine --> Monitor
    
    classDef frontend fill:#e1f5fe
    classDef business fill:#f3e5f5  
    classDef ai fill:#e8f5e8
    classDef infra fill:#fff3e0
    
    class UI,Templates,Cards,Export frontend
    class API,PM,Validation,Config business
    class Engine,Router,Parser,QC ai
    class Monitor,Deploy,Test,Metrics,Health,Validate infra
```

---

## ğŸ¯ æ‰©å±•å¼€å‘æŒ‡å—

### ğŸ”§ æ–°å¢æ¨¡æ¿ç±»å‹
**ç›®æ ‡æ–‡ä»¶**: `prompt_templates.json`
**æ‰©å±•æ–¹å¼**:
```json
{
  "new_template_id": {
    "name": "ğŸ†• æ–°æ¨¡æ¿ç±»å‹",
    "description": "é€‚ç”¨äºç‰¹å®šåœºæ™¯çš„æ¨¡æ¿",
    "max_cards": 12,
    "system_prompt": "ä½ æ˜¯ä¸“é—¨çš„...",
    "user_prompt_template": "è¯·å¤„ç†ä»¥ä¸‹{specific_type}å†…å®¹ï¼š\n\n{text}"
  }
}
```

### ğŸ¤– é›†æˆæ–°AIæ¨¡å‹
**ç›®æ ‡æ–‡ä»¶**: `main_refactored.py` ä¸­çš„ `SUPPORTED_MODELS`
**æ‰©å±•æ–¹å¼**:
```python
"new-provider/model-name": {
    "name": "æ–°æ¨¡å‹åç§°",
    "description": "æ¨¡å‹æè¿°å’Œå®šä»·ä¿¡æ¯",
    "max_tokens": 100000,
    "suggested_use": "é€‚ç”¨åœºæ™¯æè¿°"
}
```

### ğŸ“¤ æ·»åŠ æ–°å¯¼å‡ºæ ¼å¼
**ç›®æ ‡æ–‡ä»¶**: `unified_index.html` ä¸­çš„æ ¼å¼åŒ–å¼•æ“
**æ‰©å±•æ–¹å¼**:
1. æ·»åŠ  `formatNewFormat(cards)` å‡½æ•°
2. åœ¨ `getFormattedText()` æ·»åŠ æ–°çš„ case
3. åœ¨ HTML æ·»åŠ æ ¼å¼é€‰é¡¹

### ğŸ§ª æ‰©å±•æµ‹è¯•è¦†ç›–
**ç›®æ ‡ç›®å½•**: `tests/`
**æ‰©å±•æ–¹å¼**:
1. æ–°å¢ä¸“é—¨æµ‹è¯•æ–‡ä»¶ `test_new_feature.py`
2. æ›´æ–° `TESTING.md` æ–‡æ¡£
3. é›†æˆåˆ°æŒç»­é›†æˆæµç¨‹

---

## ğŸ“š ç›¸å…³æ–‡æ¡£å¯¼èˆª

### ğŸ” æ ¸å¿ƒæ–‡æ¡£é“¾æ¥
- **[README.md](./README.md)** - é¡¹ç›®æ¦‚è§ˆå’Œå¿«é€Ÿå¼€å§‹
- **[API_SPECIFICATION.md](./API_SPECIFICATION.md)** - å®Œæ•´APIè§„èŒƒ
- **[TESTING.md](./TESTING.md)** - å®Œæ•´æµ‹è¯•æŒ‡å—
- **[DEPLOYMENT_GUIDE.md](./DEPLOYMENT_GUIDE.md)** - éƒ¨ç½²å’Œè¿ç»´æŒ‡å—
- **[CHANGELOG.md](./CHANGELOG.md)** - ç‰ˆæœ¬å†å²å’Œå˜æ›´è®°å½•

### ğŸ› ï¸ å¼€å‘èµ„æº
- **[frontend/FRONTEND.md](./frontend/FRONTEND.md)** - å‰ç«¯å¼€å‘æŒ‡å—
- **[CLAUDE.md](./CLAUDE.md)** - å¼€å‘ç¯å¢ƒé…ç½®
- **[prompt_templates.json](./prompt_templates.json)** - æ¨¡æ¿é…ç½®æ–‡ä»¶

---

**ğŸ“‹ æ–‡æ¡£ä¿¡æ¯**
- **ç‰ˆæœ¬**: 2.0 (ä¼ä¸šæ¶æ„ç‰ˆ)
- **æœ€åæ›´æ–°**: 2025-06-21
- **ç»´æŠ¤å›¢é˜Ÿ**: AI Flashcard Generator æ¶æ„å›¢é˜Ÿ
- **æ¶µç›–å†…å®¹**: å®Œæ•´ç³»ç»Ÿæ¶æ„ + æ ¸å¿ƒç»„ä»¶è§£æ + æ‰©å±•æŒ‡å—
- **åŒæ­¥è¦æ±‚**: ä»£ç ç»“æ„å˜æ›´æ—¶éœ€åŒæ­¥æ›´æ–°æ­¤æ–‡æ¡£